<?xml version="1.0"?>
<!-- MGE DDF -->
<APC_DDF
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:noNamespaceSchemaLocation="http://localhost/ddf_schema/apc_ddf_1_6.xsd"
	ddfid="mge"
	ddfname="MGE UPS"
	ddfversion="28">
  <schemaVersion>1.6</schemaVersion>
  <!-- MGE UPSes specific functionality -->
  <device deviceid="mgeups">
    <oidMustExist ruleid="mgeident" oid=".1.3.6.1.4.1.705.1.1.2.0"/>

	<setProductData ruleid="typedata" field="type">UPS</setProductData>
	<setProductData ruleid="sernum" field="serial_num">
		<getOid>.1.3.6.1.4.1.705.1.1.7.0</getOid>
	</setProductData>

    <!-- upsmgBattery section -->
    <!-- Time remaining on battery -->
    <suppressRule ruleid="supressUpsmibEstimatedMinutesRemaining" suppressid="upsmib/upsmib/upsEstimatedMinutesRemaining"/>
    <numSensor ruleid="timeremainingonbatt">
      <type>timeinmin/timeremainingonbatt</type>
      <sensorId>TIME_REMAINING_ON_BATT</sensorId>
      <value>
        <round increment="0.1">
          <div>
            <op>
              <getOid>.1.3.6.1.4.1.705.1.5.1.0</getOid>
            </op>
            <op>60</op>
          </div>
        </round>
      </value>
      <label>Battery Time Remaining</label>
      <sensorSet>UPS Battery Status</sensorSet>
    </numSensor>
    
    <!-- Percent of battery remaining -->
    <suppressRule ruleid="supressUpsmibEstimatedChargeRemaining" suppressid="upsmib/upsmib/upsEstimatedChargeRemaining"/>
    <numSensor ruleid="pctofbatt">
      <type>pctofcapacity/pctofbatt</type>
      <sensorId>BATT_CAPACITY_LEFT</sensorId>
      <value><getOid>.1.3.6.1.4.1.705.1.5.2.0</getOid></value>
      <valueInc>1</valueInc>
      <label>Battery Capacity Remaining</label>
      <sensorSet>UPS Battery Status</sensorSet>
    </numSensor>

    <!-- Battery voltage -->
    <suppressRule ruleid="supressUpsmibBatteryVoltage" suppressid="upsmib/upsmib/upsBatteryVoltage"/>
    <numSensor ruleid="battvoltage">
      <type>voltage/battvoltage</type>
      <sensorId>BATT_VOLTAGE</sensorId>
      <value><mult><op><getOid>.1.3.6.1.4.1.705.1.5.5.0</getOid></op><op>0.1</op></mult></value>
      <label>Battery Voltage</label>
      <sensorSet>UPS Battery Status</sensorSet>
    </numSensor>

    <!-- Battery amperage -->
    <suppressRule ruleid="supressUpsmibBatteryCurrent" suppressid="upsmib/upsmib/upsBatteryCurrent"/>
    <numSensor ruleid="battamps">
      <type>amperage/battamps</type>
      <sensorId>BATT_AMPERAGE</sensorId>
      <value><getOid>.1.3.6.1.4.1.705.1.5.6.0</getOid></value>
      <label>Battery Amperage</label>
      <sensorSet>UPS Battery Status</sensorSet>
    </numSensor>

    <!-- Battery temperature -->
    <suppressRule ruleid="supressUpsmibBatteryTemperature" suppressid="upsmib/upsmib/upsBatteryTemperature"/>
    <numSensor ruleid="tmpofbatt">
      <type>temp/batttemp</type>
      <sensorId>BATT_TEMP</sensorId>
      <value><getOid>.1.3.6.1.4.1.705.1.5.7.0</getOid></value>
      <valueInc>1</valueInc>
      <label>Battery Temperature</label>
      <sensorSet>UPS Battery Status</sensorSet>
    </numSensor>
    
    <!-- Add basic battery status	-->
    <suppressRule ruleid="supressUpsmibBatteryStatus" suppressid="upsmib/upsmib/upsBatteryStatus"/>
    <stateSensor ruleid="batterystate">      
      <type>state/mgebattstatus</type>
      <sensorId>BATTSTATUS</sensorId>
      <value><mapValue mapid="battstatusmap"><getOid>.1.3.6.1.4.1.705.1.5.9.0</getOid><getOid>.1.3.6.1.4.1.705.1.5.14.0</getOid></mapValue></value>
      <label>Battery Status</label>
	  <enum>battstatus</enum>
      <sensorSet>UPS Battery Status</sensorSet>
    </stateSensor>

    <!-- Battery replacement status -->
    <stateSensor ruleid="batteryreplace">
      <type>state/mgebattreplace</type>
      <sensorId>BATTREPLACE</sensorId>
      <value><mapValue mapid="battreplacemap"><getOid>.1.3.6.1.4.1.705.1.5.11.0</getOid></mapValue></value>
      <label>Battery Replacement Status</label>
	  <enum>battreplace</enum>
      <sensorSet>UPS Battery Status</sensorSet>
    </stateSensor>

    <!-- Battery Charger Fault -->
    <stateSensor ruleid="batterychargerfault">
      <type>state/mgebatterychargerfault</type>
      <sensorId>BATTERY_CHARGER_FAULT</sensorId>
      <value>
        <mapValue mapid="mgeyesnomap">
          <getOid>.1.3.6.1.4.1.705.1.5.15.0</getOid>
        </mapValue>
      </value>
      <label>Battery Charger Fault</label>
	  <enum>mgeyesno</enum>
      <sensorSet>UPS Battery Status</sensorSet>
    </stateSensor>
    
    <!-- Input voltage-->
    <suppressRule ruleid="supressUpsmibInputFrequency" suppressid="upsmib/upsmib/upsInputFrequency"/>
    <numSensor ruleid="inputvoltage" index=".1.3.6.1.4.1.705.1.6.2.1.2">
      <type>voltageAC</type>
      <sensorId>_INPUT_VOLTAGE_<rowIndex/></sensorId>
      <value><div><op><getRowOid>.1.3.6.1.4.1.705.1.6.2.1.2</getRowOid></op><op>10</op></div></value>
      <label>Input Voltage - Phase<space/><rowIndex/></label>
      <sensorSet>Input - Phase<space/><rowIndex/></sensorSet>
    </numSensor>

    <!-- Input frequency -->
    <suppressRule ruleid="supressUpsmibInputVoltage" suppressid="upsmib/upsmib/upsInputVoltage"/>
    <numSensor ruleid="inputfrequency" index=".1.3.6.1.4.1.705.1.6.2.1.3">
      <type>frequency/inputfrequency</type>
      <sensorId>INPUT_FREQ_<rowIndex/></sensorId>
      <value>
        <div>
          <op>
            <getRowOid>.1.3.6.1.4.1.705.1.6.2.1.3</getRowOid>
          </op>
          <op>10</op>
        </div>
      </value>
      <label>Input Frequency - Phase<space/><rowIndex/></label>
      <sensorSet>Input - Phase<space/><rowIndex/></sensorSet>
    </numSensor>

    <!-- Input current -->
    <suppressRule ruleid="supressUpsmibInputCurrent" suppressid="upsmib/upsmib/upsInputCurrent"/>
    <numSensor ruleid="inputcurrent" index=".1.3.6.1.4.1.705.1.6.2.1.6">
      <type>amperage/input/phase</type>
      <sensorId>_INPUT_AMPS_<rowIndex/></sensorId>
      <value>
        <div>
          <op>
            <getRowOid>.1.3.6.1.4.1.705.1.6.2.1.6</getRowOid>
          </op>
          <op>10</op>
        </div>
      </value>
      <label>Input Current - Phase<space/><rowIndex/></label>
      <sensorSet>Input - Phase<space/><rowIndex/></sensorSet>
    </numSensor>

    <!-- Utility Power Failure -->
    <stateSensor ruleid="inputbadstatus">
      <type>state/mgeinputbad</type>
      <sensorId>INPUT_BAD</sensorId>
      <value>
        <mapValue mapid="mgeyesnomap">
          <getOid>.1.3.6.1.4.1.705.1.6.3.0</getOid>
        </mapValue>
      </value>
      <label>Utility Power Failure</label>
	  <enum>mgeyesno</enum>
      <sensorSet>UPS Input</sensorSet>
    </stateSensor>

    <!-- Utility Power Failure Cause -->
    <stateSensor ruleid="inputbadcause">
      <type>state/mgeinputbadcause</type>
      <sensorId>INPUT_BAD_CAUSE</sensorId>
      <value>
        <mapValue mapid="inputbadcausemap">
          <getOid>.1.3.6.1.4.1.705.1.6.4.0</getOid>
        </mapValue>
      </value>
      <label>Utility Power Failure Cause</label>
	  <enum>inputbadcause-enum</enum>
      <sensorSet>UPS Input</sensorSet>
    </stateSensor>

    <!-- Output voltage-->
    <suppressRule ruleid="supressUpsmibOutputVoltage" suppressid="upsmib/upsmib/upsOutputVoltage"/>
    <numSensor ruleid="outputvoltage" index=".1.3.6.1.4.1.705.1.7.2.1.2">
      <type>voltageAC/output/phase</type>
      <sensorId>_OUTPUT_VOLTAGE_<rowIndex/></sensorId>
      <value>
        <div>
          <op>
            <getRowOid>.1.3.6.1.4.1.705.1.7.2.1.2</getRowOid>
          </op>
          <op>10</op>
        </div>
      </value>
      <label>Output Voltage - Phase<space/><rowIndex/></label>
      <sensorSet>Output - Phase<space/><rowIndex/></sensorSet>
    </numSensor>

    <!-- Output freqency -->
    <suppressRule ruleid="supressUpsmibOutputFrequency" suppressid="upsmib/upsmib/upsOutputFrequency"/>
    <numSensor ruleid="outputfrequency" index=".1.3.6.1.4.1.705.1.7.2.1.3">
      <type>frequency/outputfrequency</type>
      <sensorId>OUTPUT_FREQ_<rowIndex/></sensorId>
      <value>
        <div>
          <op>
            <getRowOid>.1.3.6.1.4.1.705.1.7.2.1.3</getRowOid>
          </op>
          <op>10</op>
        </div>
      </value>
      <label>Output Frequency - Phase<space/><rowIndex/></label>
      <sensorSet>Output - Phase<space/><rowIndex/></sensorSet>
    </numSensor>

    <!-- Output load -->
    <suppressRule ruleid="supressUpsmibOutputPercentLoad" suppressid="upsmib/upsmib/upsOutputPercentLoad"/>
    <numSensor ruleid="outputload" index=".1.3.6.1.4.1.705.1.7.2.1.4">
      <type>pctofcapacity/outputload/phase</type>
      <sensorId>OUTPUT_LOAD_<rowIndex/></sensorId>
      <value>
        <getRowOid>.1.3.6.1.4.1.705.1.7.2.1.4</getRowOid>
      </value>
      <valueInc>1</valueInc>
      <label>Output Load - Phase<space/><rowIndex/></label>
      <sensorSet>Output - Phase<space/><rowIndex/></sensorSet>
    </numSensor>

    <!-- Output current -->
    <suppressRule ruleid="supressUpsmibOutputCurrent" suppressid="upsmib/upsmib/upsOutputCurrent"/>
    <numSensor ruleid="outputcurrent" index=".1.3.6.1.4.1.705.1.7.2.1.5">
      <type>amperage/output/phase</type>
      <sensorId>_OUTPUT_AMPS_<rowIndex/></sensorId>
      <value>
        <div>
          <op>
            <getRowOid>.1.3.6.1.4.1.705.1.7.2.1.5</getRowOid>
          </op>
          <op>10</op>
        </div>
      </value>
      <label>Output Current - Phase<space/><rowIndex/></label>
      <sensorSet>Output - Phase<space/><rowIndex/></sensorSet>
    </numSensor>

	<!-- use phase voltage and current to derive VA -->
	<numSensor ruleid="phaseoutputva" index=".1.3.6.1.4.1.705.1.7.2.1.2">
	  <type>powerVA</type>
	  <sensorId>OUTPUT_APPARENT_POWER_<rowIndex/></sensorId>
	  <!-- Apparent power per phase is total VA capacity/3 x load pct per phase/100 -->
	  <value>
	    <div>
		  <op>
	        <mult>
			  <op><getRowOid>.1.3.6.1.4.1.705.1.7.2.1.2</getRowOid></op>
			  <op><getRowOid>.1.3.6.1.4.1.705.1.7.2.1.5</getRowOid></op>
			</mult>
		  </op>
		  <!-- using decivolts and deciamps so adjust sqrt(3) -->
		  <op>173</op>
		</div>
	  </value>
	  <label>Output Power VA - Phase<space/><rowIndex/></label>
	  <sensorSet>Output - Phase<space/><rowIndex/></sensorSet>
	</numSensor>

    <!-- Output power -->
    <suppressRule ruleid="supressUpsmibOutputPower" suppressid="upsmib/upsmib/upsOutputPower"/>
    <numSensor ruleid="outputpower" index=".1.3.6.1.2.1.33.1.4.4.1.4">
      <type>powerW</type>
      <sensorId>_OUTPUT_POWER_<rowIndex/></sensorId>
      <value>
        <mult>
          <op>
            <getRowOid>.1.3.6.1.2.1.33.1.4.4.1.4</getRowOid>
          </op>
          <op>1</op>
        </mult>
      </value>
		<valueInc>1</valueInc>
      <label>Output Power - Phase<space/><rowIndex/></label>
      <sensorSet>Output - Phase<space/><rowIndex/></sensorSet>
    </numSensor>

    
    <!-- Output On Battery -->
    <stateSensor ruleid="onbattery">
      <type>state/mgeonbattery</type>
      <sensorId>ONBATTERY</sensorId>
      <value>
        <mapValue mapid="mgeyesnomap">
          <getOid>.1.3.6.1.4.1.705.1.7.3.0</getOid>
        </mapValue>
      </value>
      <label>On Battery</label>
	  <enum>mgeyesno</enum>
      <sensorSet>UPS Output</sensorSet>
    </stateSensor>

    <!-- Output On Bypass -->
    <stateSensor ruleid="onbypass">
      <type>state/mgeonbypass</type>
      <sensorId>ONBYPASS</sensorId>
      <value>
        <mapValue mapid="mgeyesnomap">
          <getOid>.1.3.6.1.4.1.705.1.7.4.0</getOid>
        </mapValue>
      </value>
      <label>On Bypass</label>
	  <enum>mgeyesno</enum>
      <sensorSet>UPS Output</sensorSet>
    </stateSensor>

    <!-- Utility Off -->
    <stateSensor ruleid="utilityoff">
      <type>state/mgeutilityoff</type>
      <sensorId>UTILITY_OFF</sensorId>
      <value>
        <mapValue mapid="mgeyesnomap">
          <getOid>.1.3.6.1.4.1.705.1.7.7.0</getOid>
        </mapValue>
      </value>
      <label>Utility Off</label>
	  <enum>mgeyesno</enum>
      <sensorSet>UPS Output</sensorSet>
    </stateSensor>

    

    <!-- Inverter Off -->
    <stateSensor ruleid="inverteroff">
      <type>state/mgeinverteroff</type>
      <sensorId>InverterOff</sensorId>
      <value>
        <mapValue mapid="mgeyesnomap">
          <getOid>.1.3.6.1.4.1.705.1.7.9.0</getOid>
        </mapValue>
      </value>
      <label>Inverter Off</label>
	  <enum>mgeyesno</enum>
      <sensorSet>UPS Output</sensorSet>
    </stateSensor>

    <!-- Output Overload -->
    <stateSensor ruleid="outputoverload">
      <type>state/mgeoutputoverload</type>
      <sensorId>OUTPUT_OVERLOAD</sensorId>
      <value>
        <mapValue mapid="mgeyesnomap">
          <getOid>.1.3.6.1.4.1.705.1.7.10.0</getOid>
        </mapValue>
      </value>
      <label>Output Overload</label>
	  <enum>mgeyesno</enum>
      <sensorSet>UPS Output</sensorSet>
    </stateSensor>

    <!-- Output Over temp -->
    <stateSensor ruleid="overtemp">
      <type>state/mgeovertemp</type>
      <sensorId>OVER_TEMPERATURE</sensorId>
      <value>
        <mapValue mapid="mgeyesnomap">
          <getOid>.1.3.6.1.4.1.705.1.7.11.0</getOid>
        </mapValue>
      </value>
      <label>Over Temperature</label>
	  <enum>mgeyesno</enum>
      <sensorSet>UPS Output</sensorSet>
    </stateSensor>
    
    <valueMap ruleid="battstatusmap">
      <valueIn>11</valueIn><valueOut>3</valueOut>
      <valueIn>12</valueIn><valueOut>3</valueOut>
      <valueIn>21</valueIn><valueOut>2</valueOut>
      <valueIn>22</valueIn><valueOut>1</valueOut>
      <valueIn>*</valueIn><valueOut>0</valueOut>
    </valueMap>

    <valueMap ruleid="battreplacemap">
      <valueIn>1</valueIn><valueOut>1</valueOut>
      <valueIn>2</valueIn><valueOut>0</valueOut>
      <valueIn>*</valueIn><valueOut>2</valueOut>
    </valueMap>

    <valueMap ruleid="inputbadcausemap">
      <valueIn>1</valueIn><valueOut>1</valueOut>
      <valueIn>2</valueIn><valueOut>2</valueOut>
      <valueIn>3</valueIn><valueOut>3</valueOut>
      <valueIn>4</valueIn><valueOut>4</valueOut>
      <valueIn>*</valueIn><valueOut>0</valueOut>
    </valueMap>
    
    <valueMap ruleid="mgeyesnomap">
      <valueIn>1</valueIn><valueOut>1</valueOut>
      <valueIn>2</valueIn><valueOut>2</valueOut>
      <valueIn>*</valueIn><valueOut>0</valueOut>
    </valueMap>

    <enumMap ruleid="battstatus">
      <label>Unknown</label> 
      <label>Normal</label>
      <label>Low</label>
      <label>Error</label>
    </enumMap>
    
    <enumMap ruleid="battreplace">
      <label>OK</label>
      <label>Replace</label>
      <label>Unknown</label>
    </enumMap>

    <enumMap ruleid="inputbadcause-enum">
      <label>Unknown</label>
      <label>None</label>
      <label>Voltage out of Tolerance</label>
      <label>Frequency out of Tolerance</label>
      <label>No Voltage</label>
    </enumMap>
    
    <enumMap ruleid="mgeyesno">
      <label>Unknown</label>
      <label>Yes</label>
      <label>No</label>
    </enumMap>
    
  </device>
  
  <device deviceid="mgemiscsensors">
	<oidMustExist ruleid="mgeident" oid=".1.3.6.1.4.1.705.1.1.2.0"/>
	<oidMustNotMatch ruleid="largeSystems" oid = ".1.3.6.1.4.1.705.1.1.1.0">
	  <valueList>
		<value>GALAXY</value>
		<value>EPS6000</value>
		<value>COMET</value>
		<value>Galaxy 7000</value>
		<value>MGE EPS</value>
		</valueList>
	</oidMustNotMatch>
	<!-- Battery full recharge time -->
    <numSensor ruleid="battfulltime">
      <type>timeinmin/battfull</type>
      <sensorId>BATT_FULL_TIME</sensorId>
      <value>
        <round increment="0.1">
          <div>
            <op>
              <getOid>.1.3.6.1.4.1.705.1.5.8.0</getOid>
            </op>
            <op>60</op>
          </div>
        </round>
      </value>
      <label>Battery Full Recharge Time</label>
      <sensorSet>UPS Battery Status</sensorSet>
    </numSensor>
	<!-- Battery Status Unavailable -->
    <stateSensor ruleid="batterystatusunavailable">
      <type>state/mgebatterystatusunavailable</type>
      <sensorId>BATTERY_STATUS_UNAVAILABLE</sensorId>
      <value>
        <mapValue mapid="mge/mgeups/mgeyesnomap">
          <getOid>.1.3.6.1.4.1.705.1.5.10.0</getOid>
        </mapValue>
      </value>
      <label>Battery Status Unavailable</label>
	  <enum>mge/mgeups/mgeyesno</enum>
      <sensorSet>UPS Battery Status</sensorSet>
    </stateSensor>
	<!-- Battery Present -->
    <stateSensor ruleid="batterypresent">
      <type>state/mgebatterypresent</type>
      <sensorId>BATTERY_PRESENT</sensorId>
      <value>
        <mapValue mapid="mge/mgeups/mgeyesnomap">
          <getOid>.1.3.6.1.4.1.705.1.5.12.0</getOid>
        </mapValue>
      </value>
      <label>Battery Present</label>
	  <enum>mge/mgeups/mgeyesno</enum>
      <sensorSet>UPS Battery Status</sensorSet>
    </stateSensor>
	<!-- Input voltage (Min) -->
    <numSensor ruleid="mininputvoltage" index=".1.3.6.1.4.1.705.1.6.2.1.1">
      <type>voltageAC/input/phase</type>
      <sensorId>MIN_INPUT_VOLTAGE_<rowIndex/></sensorId>
      <value>
        <div>
          <op>
            <getRowOid>.1.3.6.1.4.1.705.1.6.2.1.4</getRowOid>
          </op>
          <op>10</op>
        </div>
      </value>
      <label>Input Voltage (Min) - Phase<space/><rowIndex/></label>
      <sensorSet>Input - Phase<space/><rowIndex/></sensorSet>
    </numSensor>
    <!-- Input voltage (Max) -->
    <numSensor ruleid="maxinputvoltage" index=".1.3.6.1.4.1.705.1.6.2.1.1">
      <type>voltageAC</type>
      <sensorId>MAX_INPUT_VOLTAGE_<rowIndex/></sensorId>
      <value>
        <div>
          <op>
            <getRowOid>.1.3.6.1.4.1.705.1.6.2.1.5</getRowOid>
          </op>
          <op>10</op>
        </div>
      </value>
      <label>Input Voltage (Max) - Phase<space/><rowIndex/></label>
      <sensorSet>Input - Phase<space/><rowIndex/></sensorSet>
    </numSensor>
	    <!-- Bypass Unavailable -->
    <stateSensor ruleid="bypassunavailable">
      <type>state/mgebypassunavailable</type>
      <sensorId>BYPASS_UNAVAILABLE</sensorId>
      <value>
        <mapValue mapid="mge/mgeups/mgeyesnomap">
          <getOid>.1.3.6.1.4.1.705.1.7.5.0</getOid>
        </mapValue>
      </value>
      <label>Bypass Unavailable</label>
	  <enum>mge/mgeups/mgeyesno</enum>
      <sensorSet>UPS Output</sensorSet>
    </stateSensor>
	    <!-- Bypass Not Installed -->
    <stateSensor ruleid="bypassnotinstalled">
      <type>state/mgebypassnotinstalled</type>
      <sensorId>BYPASS_NOT_INSTALLED</sensorId>
      <value>
        <mapValue mapid="mge/mgeups/mgeyesnomap">
          <getOid>.1.3.6.1.4.1.705.1.7.6.0</getOid>
        </mapValue>
      </value>
      <label>Bypass Not Installed</label>
	  <enum>mge/mgeups/mgeyesno</enum>
      <sensorSet>UPS Output</sensorSet>
    </stateSensor>
	<!-- On Boost -->
    <stateSensor ruleid="onboost">
      <type>state/mgeonboost</type>
      <sensorId>ON_BOOST</sensorId>
      <value>
        <mapValue mapid="mge/mgeups/mgeyesnomap">
          <getOid>.1.3.6.1.4.1.705.1.7.8.0</getOid>
        </mapValue>
      </value>
      <label>On Boost</label>
	  <enum>mge/mgeups/mgeyesno</enum>
      <sensorSet>UPS Output</sensorSet>
    </stateSensor>
    <!-- On Fader -->
    <stateSensor ruleid="onfader">
      <type>state/mgeonfader</type>
      <sensorId>ON_FADER</sensorId>
      <value>
        <mapValue mapid="mge/mgeups/mgeyesnomap">
          <getOid>.1.3.6.1.4.1.705.1.7.12.0</getOid>
        </mapValue>
      </value>
      <label>On Fader</label>
	  <enum>mge/mgeups/mgeyesno</enum>
      <sensorSet>UPS Output</sensorSet>
    </stateSensor>
  </device>

  <device deviceid="mge_environment">
	<oidMustExist ruleid="mge_env_sensor_table" oid=".1.3.6.1.4.1.705.1.8.7" istree="yes"/>
	<stateSensor ruleid="sensorcommfailure" index=".1.3.6.1.4.1.705.1.8.7.1.2">
      <type>state/mgecommfault</type>
      <sensorId>ENV_SENSOR_COMM_FAILURE_<rowIndex/></sensorId>
      <value>
        <mapValue mapid="mge/mgeups/mgeyesnomap">
          <getRowOid>.1.3.6.1.4.1.705.1.8.7.1.2</getRowOid>
        </mapValue>
      </value>
      <label>Communication Failure - Sensor<space/><rowIndex/></label>
	  <enum>mge/mgeups/mgeyesno</enum>
      <sensorSet>Environmental Status</sensorSet>
    </stateSensor>
	<numSensor ruleid="mge_temp_sensor" index=".1.3.6.1.4.1.705.1.8.7.1.3">
	  <rowTest>
		  <mapValue mapid="skip_dead_sensor">
			  <getRowOid>.1.3.6.1.4.1.705.1.8.7.1.3</getRowOid>
		  </mapValue>
	  </rowTest>
	  <type>temp</type>
	  <sensorId>MGE_TEMP_SENSOR_<rowIndex/></sensorId>
	  <value>
		<mult>
		  <op>0.1</op>
		  <op><getRowOid>.1.3.6.1.4.1.705.1.8.7.1.3</getRowOid></op>
		</mult>
	  </value>
	  <label>Temperature - Sensor<space/><rowIndex/></label>
	  <sensorSet>Environmental Status</sensorSet>
	</numSensor>
	<numSensor ruleid="mge_humidity_sensor" index=".1.3.6.1.4.1.705.1.8.7.1.6">
	  <rowTest>
		  <mapValue mapid="skip_dead_sensor">
			  <getRowOid>.1.3.6.1.4.1.705.1.8.7.1.6</getRowOid>
		  </mapValue>
	  </rowTest>
	  <type>humidity</type>
	  <sensorId>MGE_HUMIDITY_SENSOR_<rowIndex/></sensorId>
	  <value>
		<mult>
		  <op>0.1</op>
		  <op><getRowOid>.1.3.6.1.4.1.705.1.8.7.1.6</getRowOid></op>
		</mult>
	  </value>
	  <label>Humidity - Sensor<space/><rowIndex/></label>
	  <sensorSet>Environmental Status</sensorSet>
	</numSensor>
	<stateSensor ruleid="mge_input_contact1" index=".1.3.6.1.4.1.705.1.8.7.1.9">
		<type>drycontact</type>
		<sensorId>MGE_INPUT_CONTACT_1_<rowIndex/></sensorId>
		<value>
			<mapValue mapid="mge_input_contact_map">
				<getRowOid>1.3.6.1.4.1.705.1.8.7.1.9</getRowOid>
			</mapValue>
		</value>
		<label>Input 1 - Sensor<space/><rowIndex/></label>
		<enum>mge_input_contact_enum</enum>
		<sensorSet>Environmental Status</sensorSet>
	</stateSensor>
	<stateSensor ruleid="mge_input_contact2" index=".1.3.6.1.4.1.705.1.8.7.1.10">
		<type>drycontact</type>
		<sensorId>MGE_INPUT_CONTACT_2_<rowIndex/></sensorId>
		<value>
			<mapValue mapid="mge_input_contact_map">
				<getRowOid>1.3.6.1.4.1.705.1.8.7.1.10</getRowOid>
			</mapValue>
		</value>
		<label>Input 2 - Sensor<space/><rowIndex/></label>
		<enum>mge_input_contact_enum</enum>
		<sensorSet>Environmental Status</sensorSet>
	</stateSensor>

	<valueMap ruleid="mge_input_contact_map">
	  <valueIn>1</valueIn><valueOut>1</valueOut>
	  <valueIn>2</valueIn><valueOut>0</valueOut>
	  <valueIn>*</valueIn><valueOut>2</valueOut>
	</valueMap>
	<enumMap ruleid="mge_input_contact_enum">
	  <label>Open</label>
	  <label>Closed</label>
	  <label>Unknown</label>
	</enumMap>
	<valueMap ruleid="skip_dead_sensor">
		<!-- skip sensors returning 0 -->
		<valueIn>0</valueIn><valueOut>[false]</valueOut>
		<!-- include the rest -->
		<valueIn>*</valueIn><valueOut>[true]</valueOut>
	</valueMap>
	<!-- Low Temperature Alarm -->
	<alarmFlags2 ruleid="mge_low_temperature_alarm" index=".1.3.6.1.4.1.705.1.8.7.1.4">
	  <value>
		<getRowOid>.1.3.6.1.4.1.705.1.8.7.1.4</getRowOid>
	  </value>
	  <alarmFlagsTest match="1">
		<name>
		  <activeText>Low Temperature Threshold Violation</activeText>
		  <inactiveText>Low Temperature Threshold Violation Cleared</inactiveText>
		</name>
		<severity>critical</severity>
		<category>Temperature</category>
		<description>
		  <activeText>A low temperature threshold violation exists for Sensor<space/><getRowOid>.1.3.6.1.4.1.705.1.8.7.1.1</getRowOid>.</activeText>
		  <inactiveText>A low temperature threshold violation no longer exists for Sensor<space/><getRowOid>.1.3.6.1.4.1.705.1.8.7.1.1</getRowOid>.</inactiveText>
		</description>
		<alarmRecommendedActions>
		  <recommendedActionId>Make sure the threshold is set correctly at the device, and the central air conditioning system is functioning properly.</recommendedActionId>
		</alarmRecommendedActions>
	  </alarmFlagsTest>
	</alarmFlags2>
	<!-- High Temperature Alarm -->
	<alarmFlags2 ruleid="mge_hi_temperature_alarm" index=".1.3.6.1.4.1.705.1.8.7.1.5">
	  <value>
		<getRowOid>.1.3.6.1.4.1.705.1.8.7.1.5</getRowOid>
	  </value>
	  <alarmFlagsTest match="1">
		<name>
		  <activeText>High Temperature Threshold Violation</activeText>
		  <inactiveText>High Temperature Threshold Violation Cleared</inactiveText>
		</name>
		<severity>critical</severity>
		<category>Temperature</category>
		<description>
		  <activeText>A high temperature threshold violation exists for Sensor<space/><getRowOid>.1.3.6.1.4.1.705.1.8.7.1.1</getRowOid>.</activeText>
		  <inactiveText>A high temperature threshold violation no longer exists for Sensor<space/><getRowOid>.1.3.6.1.4.1.705.1.8.7.1.1</getRowOid>.</inactiveText>
		</description>
		<alarmRecommendedActions>
		  <recommendedActionId>Make sure the threshold is set correctly at the device, and the central air conditioning system is functioning properly.</recommendedActionId>
		</alarmRecommendedActions>
	  </alarmFlagsTest>
	</alarmFlags2>
	<!-- Low Humidity Alarm -->
	<alarmFlags2 ruleid="mge_low_humidity_alarm" index=".1.3.6.1.4.1.705.1.8.7.1.7">
	  <value>
		<getRowOid>.1.3.6.1.4.1.705.1.8.7.1.7</getRowOid>
	  </value>
	  <alarmFlagsTest match="1">
		<name>
		  <activeText>Low Humidity Threshold Violation</activeText>
		  <inactiveText>Low Humidity Threshold Violation Cleared</inactiveText>
		</name>
		<severity>critical</severity>
		<category>Humidity</category>
		<description>
		  <activeText>A low humidity threshold violation exists for Sensor<space/><getRowOid>.1.3.6.1.4.1.705.1.8.7.1.1</getRowOid>.</activeText>
		  <inactiveText>A low humidity threshold violation no longer exists for Sensor<space/><getRowOid>.1.3.6.1.4.1.705.1.8.7.1.1</getRowOid>.</inactiveText>
		</description>
		<alarmRecommendedActions>
		  <recommendedActionId>Make sure the threshold is set correctly at the device, and the central air conditioning system is functioning properly.</recommendedActionId>
		</alarmRecommendedActions>
	  </alarmFlagsTest>
	</alarmFlags2>
	<!-- High Humidity Alarm -->
	<alarmFlags2 ruleid="mge_hi_humidity_alarm" index=".1.3.6.1.4.1.705.1.8.7.1.8">
	  <value>
		<getRowOid>.1.3.6.1.4.1.705.1.8.7.1.8</getRowOid>
	  </value>
	  <alarmFlagsTest match="1">
		<name>
		  <activeText>High Humidity Threshold Violation</activeText>
		  <inactiveText>High Humidity Threshold Violation Cleared</inactiveText>
		</name>
		<severity>critical</severity>
		<category>Humidity</category>
		<description>
		  <activeText>A high humidity threshold violation exists for Sensor<space/><getRowOid>.1.3.6.1.4.1.705.1.8.7.1.1</getRowOid>.</activeText>
		  <inactiveText>A high humidity threshold violation no longer exists for Sensor<space/><getRowOid>.1.3.6.1.4.1.705.1.8.7.1.1</getRowOid>.</inactiveText>
		</description>
		<alarmRecommendedActions>
		  <recommendedActionId>Make sure the threshold is set correctly at the device, and the central air conditioning system is functioning properly.</recommendedActionId>
		</alarmRecommendedActions>
	  </alarmFlagsTest>
	</alarmFlags2>
  </device>
  <device deviceid="mgeUpsGalaxy">
    <oidMustExist ruleid="mgeident" oid=".1.3.6.1.4.1.705.1.1.2.0"/>
	<oidMustMatch ruleid="onlyMgeGalaxyTypes" oid = ".1.3.6.1.4.1.705.1.1.1.0">
	  <valueList>
		<value>GALAXY</value>
		<value>EPS6000</value>
		<value>MGE EPS</value>
	  </valueList>
	</oidMustMatch>
	<suppressRule ruleid="stompmib2model" suppressid="core/mib2data/modeldata"/>
	<setProductData ruleid="modeldata" field="model">
	  <getOid>.1.3.6.1.2.1.1.1.0</getOid>
	</setProductData>
	<setProductData ruleid="serialnum" field="serial_num">
	  <getOid>.1.3.6.1.4.1.705.1.1.7.0</getOid>
	</setProductData>
	<!-- suppress the following rules which do not apply to the Galaxy Family -->
	<suppressRule ruleid="supressUpsBypassPower" suppressid="upsmib/upsmib/upsBypassPower"/>
	<suppressRule ruleid="supressUpsInputPower" suppressid="upsmib/upsmib/upsInputTruePower"/>
	<suppressRule ruleid="supressUpsmibOutputPercentLoad" suppressid="upsmib/upsmib/upsOutputPercentLoad"/>
	<suppressRule ruleid="supressUpsOutputSource" suppressid="upsmib/upsmib/upsOutputSource"/>
	<suppressRule ruleid="supressOverTemp" suppressid="mge/mgeups/overtemp"/>
	<suppressRule ruleid="supressUpsTimeOnBatt" suppressid="upsmib/upsmib/upsSecondsOnBattery"/>
	<suppressRule ruleid="supressBattChargerFault" suppressid="mge/mgeups/batterychargerfault"/>
	<suppressRule ruleid="suppressBypassVoltage" suppressid="upsmib/upsmib/upsBypassVoltage" />
	<suppressRule ruleid="suppressBypassFrequency" suppressid="upsmib/upsmib/upsBypassFrequency" /> 
	<suppressRule ruleid="suppressBypassCurrent" suppressid="upsmib/upsmib/upsBypassCurrent" />
	
	<!-- battery amps for galaxy and eps are returned as U16, but need to be I16 -->
	<suppressRule ruleid="suppressBatteryCurrent" suppressid="mge/mgeups/battamps" />
	<numSensor ruleid="battamps">
      <type>amperage/battamps</type>
      <sensorId>BATT_AMPERAGE</sensorId>
	  <value>
		<if>
		  <op>
			<ge>
			  <op><getOid>.1.3.6.1.4.1.705.1.5.6.0</getOid></op>
			  <op>32768</op>
			</ge>
		  </op>
		  <!-- true expression: convert the returned value to I16 -->
          <op>
			<sub>
			  <op>
				<sub>
				  <op><getOid>.1.3.6.1.4.1.705.1.5.6.0</getOid></op>
				  <op>1</op>
				</sub>
			  </op>
			  <op>65535</op>
			</sub>
		  </op>
		  <!-- false expression: use the returned value as is -->
		  <op><getOid>.1.3.6.1.4.1.705.1.5.6.0</getOid></op>
		</if>
	  </value>
      <label>Battery Amperage</label>
      <sensorSet>UPS Battery Status</sensorSet>
    </numSensor>

  </device>

  <device deviceid="mgeUpsGalaxy7k">
    <oidMustExist ruleid="mgeident" oid=".1.3.6.1.4.1.705.1.1.2.0"/>
	<oidMustMatch ruleid="onlyMgeGalaxy7k" oid = ".1.3.6.1.4.1.705.1.1.1.0">
	  <valueList><value>Galaxy 7000</value></valueList>
	</oidMustMatch>
	<suppressRule ruleid="stompmib2model" suppressid="core/mib2data/modeldata"/>
	<setProductData ruleid="modeldata" field="model">
	  <getOid>.1.3.6.1.2.1.1.1.0</getOid>
	</setProductData>
	<setProductData ruleid="serialnum" field="serial_num">
	  <getOid>.1.3.6.1.4.1.705.1.1.7.0</getOid>
	</setProductData>
	<!-- Battery Current: uses deciAmps, not Amps as indicated in MIB -->
	<suppressRule ruleid="suppressBatteryCurrent" suppressid="mge/mgeups/battamps"/>
	<numSensor ruleid="battamps">
      <type>amperage/battamps</type>
      <sensorId>BATT_AMPERAGE</sensorId>
      <value><mult><op><getOid>.1.3.6.1.4.1.705.1.5.6.0</getOid></op><op>0.1</op></mult></value>
      <label>Battery Amperage</label>
      <sensorSet>UPS Battery Status</sensorSet>
    </numSensor>
	<!-- Input voltage-->
	<suppressRule ruleid="suppressInputVoltage" suppressid="mge/mgeups/inputvoltage"/>
	<numSensor ruleid="inputvoltage" index=".1.3.6.1.4.1.705.1.6.2.1.2">
	  <type>voltageAC</type>
	  <sensorId>INPUT_VOLTAGE_<rowNumber/></sensorId>
	  <value>
		<div>
		  <op><getRowOid>.1.3.6.1.4.1.705.1.6.2.1.2</getRowOid></op>
		  <op>10</op>
		</div>
	  </value>
	  <label>Input Voltage - Phase<space/><baseNToInt base="10"><add><op>1</op><op><rowNumber/></op></add></baseNToInt></label>
	  <sensorSet>Input - Phase<space/><baseNToInt base="10"><add><op>1</op><op><rowNumber/></op></add></baseNToInt></sensorSet>
	</numSensor>
	<!-- Input Frequency -->
	<suppressRule ruleid="suppressInputFrequency" suppressid="mge/mgeups/inputfrequency"/>
	<numSensor ruleid="inputfrequency" index=".1.3.6.1.4.1.705.1.6.2.1.2">
	  <type>frequency</type>
	  <sensorId>INPUT_FREQ_<rowNumber/></sensorId>
	  <value>
		<div>
		  <op><getRowOid>.1.3.6.1.4.1.705.1.6.2.1.3</getRowOid></op>
		  <op>10</op>
		</div>
	  </value>
	  <label>Input Frequency - Phase<space/><baseNToInt base="10"><add><op>1</op><op><rowNumber/></op></add></baseNToInt></label>
	  <sensorSet>Input - Phase<space/><baseNToInt base="10"><add><op>1</op><op><rowNumber/></op></add></baseNToInt></sensorSet>
	</numSensor>
	<!-- Input Current -->
	<suppressRule ruleid="suppressInputCurrent" suppressid="mge/mgeups/inputcurrent"/>
	<numSensor ruleid="inputcurrent" index=".1.3.6.1.4.1.705.1.6.2.1.2">
	  <type>amperage</type>
	  <sensorId>INPUT_AMPS_<rowNumber/></sensorId>
	  <value>
		<div>
		  <op><getRowOid>.1.3.6.1.4.1.705.1.6.2.1.6</getRowOid></op>
		  <op>10</op>
		</div>
	  </value>
	  <label>Input Current - Phase<space/><baseNToInt base="10"><add><op>1</op><op><rowNumber/></op></add></baseNToInt></label>
	  <sensorSet>Input - Phase<space/><baseNToInt base="10"><add><op>1</op><op><rowNumber/></op></add></baseNToInt></sensorSet>
	</numSensor>
	<!-- Output Voltage -->
	<suppressRule ruleid="suppressOutputVoltage" suppressid="mge/mgeups/outputvoltage"/>
	<numSensor ruleid="outputvoltage" index=".1.3.6.1.4.1.705.1.7.2.1.2">
	  <type>voltageAC</type>
	  <sensorId>OUTPUT_VOLTAGE_<rowNumber/></sensorId>
	  <value>
		<div>
		  <op><getRowOid>.1.3.6.1.4.1.705.1.7.2.1.2</getRowOid></op>
		  <op>10</op>
		</div>
	  </value>
	  <label>Output Voltage - Phase<space/><baseNToInt base="10"><add><op>1</op><op><rowNumber/></op></add></baseNToInt></label>
	  <sensorSet>Output - Phase<space/><baseNToInt base="10"><add><op>1</op><op><rowNumber/></op></add></baseNToInt></sensorSet>
	</numSensor>
	<!-- Output Frequency -->
	<suppressRule ruleid="suppressOutputFrequency" suppressid="mge/mgeups/outputfrequency"/>
	<numSensor ruleid="outputfrequency" index=".1.3.6.1.4.1.705.1.7.2.1.2">
	  <type>frequency</type>
	  <sensorId>OUTPUT_FREQ_<rowNumber/></sensorId>
	  <value>
		<div>
		  <op><getRowOid>.1.3.6.1.4.1.705.1.7.2.1.3</getRowOid></op>
		  <op>10</op>
		</div>
	  </value>
	  <label>Output Frequency - Phase<space/><baseNToInt base="10"><add><op>1</op><op><rowNumber/></op></add></baseNToInt></label>
	  <sensorSet>Output - Phase<space/><baseNToInt base="10"><add><op>1</op><op><rowNumber/></op></add></baseNToInt></sensorSet>
	</numSensor>
	<!-- Output Load -->
	<suppressRule ruleid="suppressOutputLoad" suppressid="mge/mgeups/outputload"/>
	<numSensor ruleid="outputload" index=".1.3.6.1.4.1.705.1.7.2.1.2">
      <type>pctofcapacity/outputload/phase</type>
      <sensorId>OUTPUT_LOAD_<rowNumber/></sensorId>
      <value>
        <getRowOid>.1.3.6.1.4.1.705.1.7.2.1.4</getRowOid>
      </value>
      <valueInc>1</valueInc>
      <label>Output Load - Phase<space/><baseNToInt base="10"><add><op>1</op><op><rowNumber/></op></add></baseNToInt></label>
      <sensorSet>Output - Phase<space/><baseNToInt base="10"><add><op>1</op><op><rowNumber/></op></add></baseNToInt></sensorSet>
    </numSensor>
	<!-- Output Current -->
	<suppressRule ruleid="suppressOutputCurrent" suppressid="mge/mgeups/outputcurrent"/>
	<numSensor ruleid="outputcurrent" index=".1.3.6.1.4.1.705.1.7.2.1.2">
	  <type>amperage</type>
	  <sensorId>OUTPUT_AMPS_<rowNumber/></sensorId>
	  <value>
		<div>
		  <op><getRowOid>.1.3.6.1.4.1.705.1.7.2.1.5</getRowOid></op>
		  <op>10</op>
		</div>
	  </value>
	  <label>Output Current - Phase<space/><baseNToInt base="10"><add><op>1</op><op><rowNumber/></op></add></baseNToInt></label>
	  <sensorSet>Output - Phase<space/><baseNToInt base="10"><add><op>1</op><op><rowNumber/></op></add></baseNToInt></sensorSet>
	</numSensor>
	<!-- use phase voltage and current to derive VA -->
	<suppressRule ruleid="suppressOutputVA" suppressid="mge/mgeups/phaseoutputva"/>
	<numSensor ruleid="phaseoutputva" index=".1.3.6.1.4.1.705.1.7.2.1.2">
	  <type>powerVA</type>
	  <sensorId>OUTPUT_APPARENT_POWER_<rowNumber/></sensorId>
	  <!-- Apparent power per phase is total VA capacity/3 x load pct per phase/100 -->
	  <value>
	    <div>
		  <op>
	        <mult>
			  <op><getRowOid>.1.3.6.1.4.1.705.1.7.2.1.2</getRowOid></op>
			  <op><getRowOid>.1.3.6.1.4.1.705.1.7.2.1.5</getRowOid></op>
			</mult>
		  </op>
		  <!-- using decivolts and deciamps so adjust sqrt(3) -->
		  <op>173</op>
		</div>
	  </value>
	  <label>Output Power VA - Phase<space/><baseNToInt base="10"><add><op>1</op><op><rowNumber/></op></add></baseNToInt></label>
	  <sensorSet>Output - Phase<space/><baseNToInt base="10"><add><op>1</op><op><rowNumber/></op></add></baseNToInt></sensorSet>
	</numSensor>
  </device>
  
  <device deviceid="mgeUpsComet">
	<oidMustExist ruleid="mgeident" oid=".1.3.6.1.4.1.705.1.1.2.0"/>
	<oidMustMatch ruleid="mgeCometModel" oid = ".1.3.6.1.4.1.705.1.1.1.0">
	  <valueList>
		<value>COMET</value>
	  </valueList>
	</oidMustMatch>
	<suppressRule ruleid="stompmib2model" suppressid="core/mib2data/modeldata"/>
	<setProductData ruleid="modeldata" field="model">
	  <getOid>.1.3.6.1.2.1.1.1.0</getOid>
	</setProductData>
	<setProductData ruleid="serialnum" field="serial_num">
	  <getOid>.1.3.6.1.4.1.705.1.1.7.0</getOid>
	</setProductData>
	<!-- suppress the following rules which do not apply to the Comet UPS -->
	<suppressRule ruleid="supressBattStatus" suppressid="mge/mgeups/batterystate"/>
	<suppressRule ruleid="suppressOutputSource" suppressid="upsmib/upsmib/upsOutputSource"/>
	<suppressRule ruleid="suppressOutputPower" suppressid="upsmib/upsmib/upsOutputPower"/>
	<suppressRule ruleid="suppressInputPower" suppressid="upsmib/upsmib/upsInputTruePower"/>
	<suppressRule ruleid="suppressInputCurrent" suppressid="mge/mgeups/inputcurrent"/>
	<suppressRule ruleid="suppressBypassVoltage" suppressid="upsmib/upsmib/upsBypassVoltage"/>
	<suppressRule ruleid="suppressBypassPower" suppressid="upsmib/upsmib/upsBypassPower"/>
	<suppressRule ruleid="suppressBypassFrequency" suppressid="upsmib/upsmib/upsBypassFrequency"/>
	<suppressRule ruleid="suppressBypassCurrent" suppressid="upsmib/upsmib/upsBypassCurrent"/>
	
	<!-- battery amps for comet are returned as U16, but need to be I16 -->
	<suppressRule ruleid="suppressBatteryCurrent" suppressid="mge/mgeups/battamps" />
	<numSensor ruleid="battamps">
      <type>amperage/battamps</type>
      <sensorId>BATT_AMPERAGE</sensorId>
	  <value>
		<if>
		  <op>
			<ge>
			  <op><getOid>.1.3.6.1.4.1.705.1.5.6.0</getOid></op>
			  <op>32768</op>
			</ge>
		  </op>
		  <!-- true expression: convert the returned value to I16 -->
          <op>
			<sub>
			  <op>
				<sub>
				  <op><getOid>.1.3.6.1.4.1.705.1.5.6.0</getOid></op>
				  <op>1</op>
				</sub>
			  </op>
			  <op>65535</op>
			</sub>
		  </op>
		  <!-- false expression: use the returned value as is -->
		  <op><getOid>.1.3.6.1.4.1.705.1.5.6.0</getOid></op>
		</if>
	  </value>
      <label>Battery Amperage</label>
      <sensorSet>UPS Battery Status</sensorSet>
    </numSensor>
	
	<!-- comet output voltage is only reported for phase 1 -->
	<suppressRule ruleid="suppressOutputVoltage" suppressid="mge/mgeups/outputvoltage"/>
	<numSensor ruleid="outputvoltage">
      <type>voltageAC</type>
      <sensorId>OUTPUT_VOLTAGE_PHASE1</sensorId>
      <value>
        <div>
          <op>
            <getOid>.1.3.6.1.4.1.705.1.7.2.1.2.1</getOid>
          </op>
          <op>10</op>
        </div>
      </value>
      <label>Output Voltage - Phase 1</label>
      <sensorSet>Output - Phase 1</sensorSet>
    </numSensor>
	
  </device>
  
  <!-- Alarms specific to the Galaxy family -->
  <device deviceid="mgeups_galaxy_alarms">
    <oidMustExist ruleid="mgeident" oid=".1.3.6.1.4.1.705.1.1.2.0"/>
	<!--
	<oidMustMatch ruleid="galaxyfamilydetect" oid = ".1.3.6.1.4.1.705.1.1.1.0">
	  <valueList>
		<value>Galaxy 7000</value>
		<value>GALAXY</value>
		<value>EPS6000</value>
		<value>COMET</value>
		<value>MGE EPS</value>
	  </valueList>
	</oidMustMatch>
	-->
	<!-- define alarms for fault oids -->
	<alarmFlags ruleid="lowBattery">
	  <value><getOid>.1.3.6.1.4.1.705.1.5.14.0</getOid></value>
	  <alarmFlagsTest match="1" log="no">
		<name>
		  <activeText>Low Battery</activeText>
		  <inactiveText>Low Battery Cleared</inactiveText>
		</name>
		<severity>critical</severity>
		<category>Battery</category>
		<description>
		  <activeText>The battery power is too low to continue to support the load; the UPS will transfer to Bypass. The load will be powered by Bypass AC.</activeText>
		  <inactiveText>A low battery condition no longer exists.</inactiveText>
		</description>
		<alarmRecommendedActions>
		  <recommendedActionId>The UPS cannot continue to use its battery power to support its load equipment. The remaining runtime equals, or is less than, the runtime defined by its "Low Battery" setting. Consider upgrading to a UPS that provides more runtime.</recommendedActionId>
		</alarmRecommendedActions>
	  </alarmFlagsTest>
	</alarmFlags>
	<alarmFlags ruleid="batteryFault">
	  <value><getOid>.1.3.6.1.4.1.705.1.5.9.0</getOid></value>
	  <alarmFlagsTest match="1" log="no">
		<name>
		  <activeText>Battery Fault</activeText>
		  <inactiveText>Battery Fault Cleared</inactiveText>
		</name>
		<severity>critical</severity>
		<category>Battery</category>
		<description>
		  <activeText>A battery fault exists.</activeText>
		  <inactiveText>A battery fault no longer exists.</inactiveText>
		</description>
		<alarmRecommendedActions>
		  <recommendedActionId>Replace all faulty batteries.</recommendedActionId>
		</alarmRecommendedActions>
	  </alarmFlagsTest>
	</alarmFlags>
	
	<alarmFlags ruleid="outputOverload">
	  <value><getOid>.1.3.6.1.4.1.705.1.7.10.0</getOid></value>
	  <alarmFlagsTest match="1" log="no">
		<name>
		  <activeText>Overload</activeText>
		  <inactiveText>Overload Cleared</inactiveText>
		</name>
		<severity>critical</severity>
		<category>Output</category>
		<description>
		  <activeText>The load exceeds 100% of rated capacity.</activeText>
		  <inactiveText>The load no longer exceeds 100% of rated capacity.</inactiveText>
		</description>
		<alarmRecommendedActions>
		  <recommendedActionId>Reduce the load on the UPS to a safe level (less than 100%) or upgrade to a unit that can support the existing load.</recommendedActionId>
		</alarmRecommendedActions>
	  </alarmFlagsTest>
	</alarmFlags>
	<alarmFlags ruleid="inputBadStatus">
	  <value><getOid>.1.3.6.1.4.1.705.1.6.3.0</getOid></value>
	  <alarmFlagsTest match="1" log="no">
		<name>
		  <activeText>Normal Mains Input Failure</activeText>
		  <inactiveText>Normal Mains Input Failure Cleared</inactiveText>
		</name>
		<severity>warning</severity>
		<category>Input</category>
		<description>
		  <activeText>An input power problem exists.</activeText>
		  <inactiveText>An input power problem no longer exists.</inactiveText>
		</description>
		<alarmRecommendedActions>
		  <recommendedActionId>Make sure the UPS is connected to its power source correctly, and that source is providing the proper power.</recommendedActionId>
		</alarmRecommendedActions>
	  </alarmFlagsTest>
	</alarmFlags>
    <alarmFlags ruleid="outputOnBattery">
    <!-- merge on battery with input bad status and match the 11 as 0x0B-->
      <value><getOid>.1.3.6.1.4.1.705.1.7.3.0</getOid><getOid>.1.3.6.1.4.1.705.1.6.3.0</getOid></value>
      <alarmFlagsTest match="B" log="no">
		<name>
		  <activeText>UPS On Battery Operation; Load is Protected</activeText>
		  <inactiveText>UPS On Battery Operation Cleared</inactiveText>
		</name>
		<severity>warning</severity>
		<category>Output</category>
		<description>
		  <activeText>On battery power in response to an input power problem.</activeText>
		  <inactiveText>No longer on battery power.</inactiveText>
		</description>
		<alarmRecommendedActions>
		  <recommendedActionId>Make sure the UPS is connected to its power source correctly, and that source is providing the proper power.</recommendedActionId>
		</alarmRecommendedActions>
	  </alarmFlagsTest>
	</alarmFlags>
		<alarmFlags ruleid="outputOnBypass">
	  <value><getOid>.1.3.6.1.4.1.705.1.7.4.0</getOid></value>
	  <alarmFlagsTest match="1" log="no">
		<name>
		  <activeText>UPS On Bypass Operation; Load is Not Protected</activeText>
		  <inactiveText>UPS On Bypass Operation Cleared</inactiveText>
		</name>
		<severity>critical</severity>
		<category>Output</category>
		<description>
		  <activeText>On bypass operation in response to an input power problem.</activeText>
		  <inactiveText>No longer on bypass power.</inactiveText>
		</description>
		<alarmRecommendedActions>
		  <recommendedActionId>The UPS is operating in bypass. Since the UPS cannot support its load if a power failure occurs, return the UPS to online operation as soon as possible.</recommendedActionId>
		</alarmRecommendedActions>
	  </alarmFlagsTest>
	</alarmFlags>
  </device>
  <!-- alarms specific to the Galaxy 7000 -->
  <device deviceid="mgeups_galaxy7k_alarms">
	<oidMustExist ruleid="mgeident" oid=".1.3.6.1.4.1.705.1.1.2.0"/>
	<oidMustMatch ruleid="galaxy7Kdetect" oid = ".1.3.6.1.4.1.705.1.1.1.0">
	  <valueList>
		<value>Galaxy 7000</value>
	  </valueList>
	</oidMustMatch>
	<alarmFlags ruleid="chargerFault">
	  <value><getOid>.1.3.6.1.4.1.705.1.5.15.0</getOid></value>
	  <alarmFlagsTest match="1" log="no">
		<name>
		  <activeText>Battery Charger Fault</activeText>
		  <inactiveText>Battery Charger Fault Cleared</inactiveText>
		</name>
		<severity>critical</severity>
		<category>Battery</category>
		<description>
		  <activeText>A battery charger fault exists.</activeText>
		  <inactiveText>A battery charger fault no longer exists.</inactiveText>
		</description>
		<alarmRecommendedActions>
		  <recommendedActionId>An internal hardware fault exists.  Contact product manufacturer.</recommendedActionId>
		</alarmRecommendedActions>
	  </alarmFlagsTest>
	</alarmFlags>
	<alarmFlags ruleid="outputOvertemp">
	  <value><getOid>.1.3.6.1.4.1.705.1.7.11.0</getOid></value>
	  <alarmFlagsTest match="1" log="no">
		<name>
		  <activeText>UPS Cabinet Temperature Fault</activeText>
		  <inactiveText>UPS Cabinet Temperature Fault Cleared</inactiveText>
		</name>
		<severity>critical</severity>
		<category>Output</category>
		<description>
		  <activeText>The UPS cabinet internal temperature exceeds the internal temperature threshold.</activeText>
		  <inactiveText>The UPS cabinet internal temperature no longer exceeds the internal temperature threshold.</inactiveText>
		</description>
		<alarmRecommendedActions>
		  <recommendedActionId>Check UPS ambient temperature.  If ambient temperature is OK, the fault may be associated with internal components.  Contact technical support.</recommendedActionId>
		</alarmRecommendedActions>
	  </alarmFlagsTest>
	</alarmFlags>
  </device>

	<device deviceid="mgeups_agent">
		<oidMustExist ruleid="mgeident" oid=".1.3.6.1.4.1.705.1.1.2.0"/>
		<oidMustExist ruleid="upsmgAgent" oid=".1.3.6.1.4.1.705.1.12" istree="yes" />

		<setProductData ruleid="upsmgAgentFirmwareVersion" field="appversion">
			<getOid>.1.3.6.1.4.1.705.1.12.12.0</getOid>
		</setProductData>

	</device>

</APC_DDF>

